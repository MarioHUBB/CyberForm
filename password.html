<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Strength Checker</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #cee0f5;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 500px;
            text-align: center;
        }
        button {
            background-color: #849ebd;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s, transform 0.2s;
        }
        button:hover {
            background-color: #6c88a3;
            transform: scale(1.05);
        }
        input[type="number"] {
            width: 60px;
            padding: 5px;
            margin-left: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        input[type="password"], input[type="text"] {
            width: 80%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
            margin-bottom: 10px;
        }
        .meter {
            margin-top: 10px;
            border-radius: 7px;
            height: 15px;
            width: 100%;
            background: #eee;
        }
        .meter span {
            display: block;
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg,#f05,#6cf);
            border-radius: 7px;
        }
        ul {
            text-align: left;
            padding-left: 20px;
        }
        label {
            display: inline-block;
            margin: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <button id="homeBtn" class="home-btn">Back to Home</button>
        <h1>Password Strength Checker</h1>

        <label for="password">Enter your password:</label>
        <input type="password" id="password" placeholder="Type your password..." autocomplete="new-password" spellcheck="false">

        <label><input type="checkbox" id="showPassword"> Show password</label>

        <div class="meter">
            <span id="bar"></span>
        </div>

        <p id="score"></p>
        <ul id="advice"></ul>

        <h3>Generate a strong password:</h3>

        <label for="length">Length:</label>
        <input type="number" id="length" min="8" max="32" value="16">

        <div>
            <label><input type="checkbox" id="useLower" checked> Include lowercase</label>
            <label><input type="checkbox" id="useUpper" checked> Include uppercase</label>
            <label><input type="checkbox" id="useDigits" checked> Include digits</label>
            <label><input type="checkbox" id="useSymbols" checked> Include symbols</label>
        </div>

        <button id="generate">Generate Password</button>
        <button id="copyPassword">Copy Password to Clipboard</button>
        <p id="copyMessage" style="color:green;"></p>
    </div>

    <script>
        const passwordInput = document.getElementById('password');
        const bar = document.getElementById('bar');
        const scoreText = document.getElementById('score');
        const adviceList = document.getElementById('advice');

        // --- Home button ---
        document.getElementById('homeBtn').addEventListener('click', () => {
            window.location.href = 'index.html';
        });

        // --- Strength meter functions ---
        function charClasses(p){
            let sets = 0;
            if (/[a-z]/.test(p)) sets += 26;
            if (/[A-Z]/.test(p)) sets += 26;
            if (/[0-9]/.test(p)) sets += 10;
            if (/[^A-Za-z0-9]/.test(p)) sets += 32;
            return sets;
        }

        function entropyBits(p){
            const sets = charClasses(p);
            if (!p || sets === 0) return 0;
            return p.length * Math.log2(sets);
        }

        function scoreFromEntropy(bits){
            if (bits < 28) return {label:'Very Weak', pct:15};
            if (bits < 36) return {label:'Weak', pct:35};
            if (bits < 60) return {label:'Reasonable', pct:60};
            if (bits < 80) return {label:'Strong', pct:80};
            return {label:'Very Strong', pct:100};
        }

        const dictionaryWords = ["password","1234","qwerty","admin","letmein","welcome","iloveyou","monkey","abc123","dragon"];

        passwordInput.addEventListener('input', () => {
            const p = passwordInput.value;
            const bits = Math.round(entropyBits(p));
            const s = scoreFromEntropy(bits);
            bar.style.width = s.pct + '%';
            scoreText.textContent = Entropy = `${bits} bits — ${s.label}`;
            
            adviceList.innerHTML = '';
            if (p.length < 8) adviceList.innerHTML += '<li>Make it longer (≥12 recommended)</li>';
            if (!/[A-Z]/.test(p)) adviceList.innerHTML += '<li>Add uppercase letters</li>';
            if (!/[a-z]/.test(p)) adviceList.innerHTML += '<li>Add lowercase letters</li>';
            if (!/[0-9]/.test(p)) adviceList.innerHTML += '<li>Add digits</li>';
            if (!/[^A-Za-z0-9]/.test(p)) adviceList.innerHTML += '<li>Add symbols or use a passphrase</li>';
            if (dictionaryWords.some(word => p.toLowerCase().includes(word))) adviceList.innerHTML += '<li>Avoid common dictionary words or sequences</li>';
        });

        // --- Show/Hide toggle ---
        document.getElementById('showPassword').addEventListener('change', function() {
            passwordInput.type = this.checked ? 'text' : 'password';
        });

        // --- Copy to clipboard ---
        document.getElementById('copyPassword').addEventListener('click', () => {
            const pass = passwordInput.value;
            if (!pass) {
                alert('No password to copy!');
                return;
            }
            navigator.clipboard.writeText(pass).then(() => {
                const msg = document.getElementById('copyMessage');
                msg.textContent = 'Password copied to clipboard!';
                setTimeout(() => msg.textContent = '', 2000);
            }).catch(err => {
                alert('Failed to copy password: ' + err);
            });
        });

        // --- Secure password generator ---
        const LOWER = 'abcdefghijklmnopqrstuvwxyz';
        const UPPER = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        const DIGITS = '0123456789';
        const SYMBOLS = '!@#$%^&*()-_=+[]{};:,.<>/?~`|\\';

        function secureRandomInt(max) {
            const array = new Uint32Array(1);
            window.crypto.getRandomValues(array);
            return array[0] % max;
        }

        function generateSecurePassword(length, useLower, useUpper, useDigits, useSymbols) {
            let charset = '';
            if (useLower) charset += LOWER;
            if (useUpper) charset += UPPER;
            if (useDigits) charset += DIGITS;
            if (useSymbols) charset += SYMBOLS;

            if (!charset) throw new Error('No character sets selected.');

            let pwd = '';
            for (let i = 0; i < length; i++) {
                pwd += charset[secureRandomInt(charset.length)];
            }
            return { pwd, charsetSize: charset.length };
        }

        document.getElementById('generate').addEventListener('click', () => {
            let length = parseInt(document.getElementById('length').value, 10);
            if (length < 8) length = 8;
            if (length > 32) length = 32;

            const useLower = document.getElementById('useLower').checked;
            const useUpper = document.getElementById('useUpper').checked;
            const useDigits = document.getElementById('useDigits').checked;
            const useSymbols = document.getElementById('useSymbols').checked;

            const { pwd } = generateSecurePassword(length, useLower, useUpper, useDigits, useSymbols);
            passwordInput.value = pwd;
            passwordInput.dispatchEvent(new Event('input')); // update strength meter
        });
    </script>
</body>
</html>